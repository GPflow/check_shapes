:py:mod:`check_shapes.checker_context`
======================================

.. py:module:: check_shapes.checker_context

.. autoapi-nested-parse::

   Utilities for accessing the ShapeChecker from a wrapping `check_shapes` decorator.



Module Contents
---------------

.. py:function:: set_shape_checker(checker)

   Sets the current shape checker in the context.


.. py:function:: get_shape_checker()

   Get the :class:`ShapeChecker` from the wrapping :func:`check_shapes` decorator.

   Behaviour is undefined if you call this from a function that is not directly wrapped in
   :func:`check_shapes` or :func:`inherit_check_shapes`.


.. py:function:: check_shape(shaped, tensor_spec, context = None)

   Raise an error if a tensor has the wrong shape.

   This uses the :class:`ShapeChecker` from the wrapping :func:`check_shapes` decorator. Behaviour
   is undefined if you call this from a function that is not directly wrapped in
   :func:`check_shapes` or :func:`inherit_check_shapes`.

   Example:

   .. literalinclude:: /examples/test_check_shapes_examples.py
      :start-after: [intermediate_results]
      :end-before: [intermediate_results]
      :dedent:

   :param shaped: The object whose shape to check.
   :param tensor_spec: Specification to check the tensor against. See "Shape specification" in our
       User Guide.
   :param context: Information about where ``shaped`` is coming from, for improved error
       messages.
   :returns: ``shaped``, for convenience.


